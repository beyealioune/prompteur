<!-- <div class="popup-overlay">
  <div class="popup-card">
    <h2>Abonnement PromptCam Premium</h2>
    <p>
      Profitez de <strong>3 jours gratuits</strong>, puis <strong>1,99&nbsp;€/mois</strong>
      pour enregistrer des vidéos sans limite.
    </p>

    <ng-container *ngIf="isIOS(); else webButtons">
      <button class="btn-unified btn-custom"
              (click)="onPayNow()"
              [disabled]="!isStoreReady || !productLoaded">
        S'abonner (Apple)
      </button>
      <button class="btn-unified btn-outline"
              (click)="onTryFree()"
              [disabled]="!isStoreReady">
        Essai gratuit 3 jours (Apple)
      </button>
      <button class="btn-unified btn-outline"
              (click)="refreshStore()"
              style="margin-top:8px">
        Restaurer mes achats
      </button>
      <div *ngIf="!isStoreReady || !productLoaded" class="iap-warning">
        Paiement Apple non prêt. Patientez ou relancez l’application.
      </div>
    </ng-container>
    <ng-template #webButtons>
      <button class="btn-unified btn-custom" (click)="onPayNow()">
        S'abonner (Stripe)
      </button>
      <button class="btn-unified btn-outline" (click)="onTryFree()">
        Essai gratuit 3 jours (Web)
      </button>
    </ng-template>

    <button class="btn-close" (click)="onClose()">Fermer</button>

    <p class="legal-links">
      <a routerLink="/politique-confidentialite" target="_blank">Politique de confidentialité</a> |
      <a href="https://www.apple.com/legal/internet-services/itunes/dev/stdeula/" target="_blank">
        Conditions d'utilisation (Apple)
      </a>
    </p>
  </div>
</div> -->


<div class="iap-container">
  <h2>Achat In-App Test (iOS)</h2>
  <div *ngIf="storeNotReady" class="alert alert-warning">
    ⚠️ Store non initialisé ou plugin manquant.
  </div>
  <ul *ngIf="products.length">
    <li *ngFor="let p of products">
      <strong>{{ p.title || p.id }}</strong> 
      <br>{{ p.description }}<br>
      <b>{{ p.price ? (p.price + ' ' + p.currency) : '' }}</b>
      <button (click)="purchase(p.id)">Acheter</button>
    </li>
  </ul>
  <button (click)="restore()" [disabled]="storeNotReady" class="restore-btn">Restaurer les achats</button>
  <div class="premium-status">
    <b>Status premium :</b> 
    <span [style.color]="isPremium ? 'green' : 'red'">
      {{ isPremium ? 'Oui' : 'Non' }}
    </span>
  </div>
</div>
